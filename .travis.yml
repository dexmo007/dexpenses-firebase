dist: trusty
language: node_js
node_js:
  - '10'
  - '11'
cache:
  npm: true
env:
  matrix:
    - TZ=UTC
    - TZ=CET
before_install:
  - cd functions
install:
  - npm install
script:
  - npm run test -- --silent
  - npm run build
jobs:
  include:
    - stage: sonar
      env: TZ=UTC
      node_js:
        - '10'
      addons:
        sonarcloud:
          organization: dexpenses
          token:
            secure: uGsYIcQyCEV7wr5xdBuCJLEw80sFOmmvaDucQs5g4tpPqnbU/t8MmSxE+3G31bo8atWZgYs7VfHAjtZuIkaFmP5rj2Pb2K/B8MsgfacUXhiVQRwIiLh7EcF4IoYFVkqLRiFM0zFy2hrHYzH010P1wUuvxpLQJ2FUm7MLKmPgRhRH+GeViRJXT3qp7tGn2qd+2tyoKAzSTNbm68z41kcBmwR+0nF/SLWq5YiXD0x1RFRW4FDRmCGt7BcJcH9ODwuRO0m/cZBwq4oyRK32+SSo6iE9Iz884y0i29xgWMQozT37Y9dx9E6bj9a/J3n0sw1aKE3LiyZUhE6cGyjH56HyaTOPRJPZVCC+kvE0ZUr3sQZ0sm/tT3JVFcBz9xC4scN48nOik9edOXhyscgwTnv9Ii1seOX4BOG647tihdsIERbu/HllLGQb4jTnb3ZxeUXwvslkJxyvGL9Q3qDDDDsew6a+kA2bR9J2n41rMv2BloLT6HexAc0O5u+riCxcOWd+1JNeRN9t2d3h1B9rbhAK/bSKOqaXvwBztmHqvbmSyn2FhM3CPODkh4OmrRKD8zK963Gi0bekqZKtmXBEEaAC+4TLyzb7ge5BPSTwEPdBrCZSZwE0eMADBwG/SAHyj1PMYL0fY1NhPYB7JHdyn7sNT47SpGwzjRGC8lvPgeclt14=
      script:
        - npm run test:coverage
        - npm run lint:sonar
        - sonar-scanner
    - stage: deploy
      script: skip
      before_deploy: cd $TRAVIS_BUILD_DIR
      deploy:
        on:
          branch: master
        env: TZ=UTC
        node_js:
          - '11'
        skip_cleanup: true
        provider: firebase
        token:
          secure: hVCf48s6EX6PWzE/cBBrzTAWaKcKgnfQvLsSf/vlwSG1lfr7yaO24ZBFVzwdDi2/SroEcrnENleItjVBgBPUlZufPh6y1RES3anjv4cIqbEnvdL0TgJTh8JQvfU8DrVdgUdJ8/7dlRCTdYcnU7w0czScnWMzLwZyVrr6GUz0Qn61INmObEDQm0oEdN1tfQTMjGxBigurCJ/PFJ7hkGckda7lvtUA5baWRWoCgJeLaujgY7Ss0XZS1qh9U/ANAW94+WnxnGLor4crnq+tyuwo2WtA8rtpzP29hXVGaDMunQRkRTOS4XAGpglcp5rPYREASV/qySX3Vi7JEdnks1e1GUTVSeTYJq/qN3Bv9P/qso1v+kqLCfV4yqZUEbAU+7DegzUbePtuSm0qxiZHCQdtOtocF+Kgu4gU60/N60EeztZVWjMAFFplwGvN1BjHKY+iCMTI21tln5Vb/DGc5EhFcq5kHkKTT61hXmELHnaIBFfvGFNOeAtRyA1LGCr8WmEwsaTx9KqR1wMakYbpomNdXbXOYaJkPSNjntixmlVo0LibwYA1bQo6sMjnoxbg9s2g4cDpjRnPdwxefcaM9V0QmYy9fiZ2mzGnZ8xxaII0aL/7NlhN86O8hHuNFHV2ufMRDqD7BXUAXjkA8MbDEsJKq7gomWBTMyC7zg7zG4SymSE=
